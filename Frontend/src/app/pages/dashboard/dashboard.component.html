<div id="dashboard">

  <button class="btn dashboard-right-button-desktop" (click)="requestGroups()">Dashboard aktualisieren</button>
  <h1>Dashboard</h1>
  <button class="btn dashboard-right-button-mobile" (click)="requestGroups()">Dashboard aktualisieren</button>
  <hr />
  <table>
    <tr>
      <td>
        <a routerLink="/employee/me">{{user | employeeName}}</a>
      </td>
      <td>
        <button type="button" class="btn btn-icon btn-success" aria-label="done" *ngIf="user.erreichbar" (click)="alterErreichbar()">
          <clr-icon shape="check"></clr-icon>
        </button>
        <button type="button" class="btn btn-icon btn-warning" aria-label="warning" *ngIf="!user.erreichbar" (click)="alterErreichbar()">
          <clr-icon shape="times"></clr-icon>
        </button>
        <clr-signpost>
          <clr-signpost-content *clrIfOpen>
            Klicken Sie auf
            {{user.erreichbar ? "den Haken, um als abwesend" : "das Kreuz, um als anwesend"}}
            angezeigt zu werden
          </clr-signpost-content>
        </clr-signpost>
      </td>
      <td>
        <form clrForm (submit)="changeStatus()">
          <clr-datalist-container>
            <label>Status</label>
            <input name="Option" clrDatalistInput [(ngModel)]="status" />
            <datalist>
              <option [value]="'Online'">Online</option>
              <option [value]="'Abwesend'">Abwesend</option>
              <option [value]="'Nicht stören'">Nicht stören</option>
            </datalist>
          </clr-datalist-container>
        </form>
      </td>
      <td>
        <a routerLink="/employee/{{user.vertreter}}">Vertreter</a>
      </td>
    </tr>
  </table>
  <hr />

  <div *ngIf="['admin', 'root', 'headOfDepartment'].includes(user.rechteklasse)">
    <button class="btn dashboard-right-button-desktop" (click)="toggleAllGroups()">Anzeigen</button>
    <h2>Alle Arbeitsgruppen</h2>
    <hr />

    <div [@inOutAnimation]="viewAllGroups">
      <ng-container *ngIf="['admin', 'root'].includes(user.rechteklasse)">
        <button class="btn" (click)="openWizard()">Arbeitsgruppe hinzufügen</button>
        <dashboard-add-group-wizard [(open)]="open"></dashboard-add-group-wizard>
      </ng-container>

      <ng-container *ngIf="['admin', 'root', 'headOfDepartment'].includes(user.rechteklasse)">
        <ng-container *ngIf="groups">
          <dashboard-groups [groups]="groups"></dashboard-groups>
        </ng-container>
      </ng-container>

      <br />
      <hr />
      <br />
    </div>
  </div>

  <div id="myGroups">
    <button class="btn dashboard-right-button-desktop" (click)="toggleMyGroups()">Anzeigen</button>
    <h2>Meine Arbeitsgruppen</h2>
    <hr />

    <div [@inOutAnimation]="viewMyGroups">
      <ng-container *ngFor="let g of userGroups;let i = index">
        <h3>Mitarbeiter*innen der Gruppe {{g.bezeichnung}}</h3>
        <ng-container
          *ngIf="user.rechteklasse === 'headOfDepartment' || user.rechteklasse === 'admin' || user.rechteklasse === 'root'">
          <button class="btn" (click)="addUser(i)">Mitarbeiter*in hinzufügen</button>
          <button class="btn" (click)="removeUser(i)">Mitarbeiter*in entfernen</button>

          <dashboard-add-user-to-group [(opened)]="addToGroup[i]" [mode]="'add'" [group]="g">
          </dashboard-add-user-to-group>
          <dashboard-add-user-to-group [(opened)]="removeFromGroup[i]" [mode]="'remove'" [group]="g">
          </dashboard-add-user-to-group>
        </ng-container>

        <dashboard-group-overview *ngIf="!isMobile" [group]="g.arbeitsgruppenID"></dashboard-group-overview>
        <dashboard-groups-panel *ngIf="isMobile" [group]="g.arbeitsgruppenID"></dashboard-groups-panel>
        <hr />

      </ng-container>
    </div>
  </div>

</div>
